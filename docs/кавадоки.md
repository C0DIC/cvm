# Кава

Кава это `ассемблер` для виртуальной машины (Виртуальная Машина Ката)

## **Инструкции**

Одна линия **кода** это одна **инструкция**, за исключением пустых и закомментированных строк.

Есть 2 типа инструкций: `с аргументами` и `без аргументов`.

Пример инструкций `с аргументами`:

- [push](#push)
- goto
- cmp
- и тд.

Пример инструкций `без аргументов`:

- [add](#add)
- [hlt](#hlt)
- [sub](#sub)
- и тд.

### push

Позволяет добавить элемент в конец стэка.
*Выдает ошибку, если стэк переполнен*

``` text
push (i64 | f64 | string)
```

Пример:

``` nasm
push 10
push "str"
push 1.43
```

### add

Складывает два элемента над
Выдает ошибку, если размер стэка меньше 2-х

``` nasm
push 10
push 20    // Теперь размер стэка 2
add        // 10 + 10. Размер стэка теперь 1, а элемент стэка 20
```

### sub

От элемента на 2 *позиции выше* отнимает элемент над инструкцией.
Выдает ошибку, если размер стэка меньше 2-х

``` nasm
push 5
push 10    // Размер стэка теперь 2
sub        // 5 - 10. Размер теперь 1, а элемент -5
```

### mult

Умножает 2 элемента над инструкцией.
Выдает ошибку, если размер стэка меньше 2-х

``` nasm
push 5
push 10    // Размер стэка теперь 2
mult       // 5 * 10. Размер теперь 1, а элемент 50
```

### div

Делит элемент на 2 *позиции выше* на элемент над инструкцией.
Выдает ошибку, если размер стэка меньше 2-х

``` nasm
push 35
push 5    // Размер стэка теперь 2
div       // 45 / 5. Размер стэка теперь 1, а элемент 7
```

### mod

Нахождение остатка от деления элемента на 2 *позиции выше* на элемент над инструкцией.
Выдает ошибку, если размер стэка меньше 2-х

``` nasm
push 36
push 5    // Размер стэка теперь 2
mod       // 36 % 5. Размер стэка теперь 1, а элемент 1
```

### wrt
Вывод элемента над инструкцией в стандартный выход.
Выдает ошибку, если нечего вывести или стэк пустой

```text
wrt (str | i64 | f64)
```

``` nasm
push 56
wrt i64               // Выведет 56
push "привет, мир!"
wrt str               // Выведет "привет, мир!"
```

### wrtn

Вывод элемента над инструкцией в стандартный выход с переносом на новую строку.
Выдает ошибку, если нечего вывести или стэк пустой

```text
wrtn (str | i64 | f64)
```

``` nasm
push 56
wrtn i64               // Выведет 56
push "привет, мир!"
wrtn str               // Выведет "привет, мир!"
```

### hlt

Немедленно останавливает работу виртуальной машины. Как `exit()` в Си или Пайтоне.

``` nasm
hlt
push 5       // Мертвый код. Машина до него не дойдет
```

### goto

"Перепрыгивание" с инструкции на инструкцию при помощи индекса или названий блоков.

- Инструкции - строчки кода, где есть настоящие инструкции
- Пустые строки и комментарии не учитываются (не берутся за строку)
- Счёт инструкций начинается с 0

``` nasm
goto 5      // goto с индексами



push 2     // 5-ая строка
push 5
mult
wrtn i64
```

``` nasm
goto main    // Блочный goto

exit:
    hlt

main:
    push 5
    push 5
    add
```
